From 249a124d84e586f43aa47682d512a83a4322fb4b Mon Sep 17 00:00:00 2001
From: Marc Kleine-Budde <mkl@pengutronix.de>
Date: Wed, 30 May 2018 11:47:23 +0200
Subject: [PATCH 1/3] networkd-link: link_configure(); factor out
 link_configure_can() into separate function

---
 src/network/networkd-link.c | 28 ++++++++++++++++------------
 1 file changed, 16 insertions(+), 12 deletions(-)

diff --git a/src/network/networkd-link.c b/src/network/networkd-link.c
index 4c57fa1793..c29ae30ef0 100644
--- a/src/network/networkd-link.c
+++ b/src/network/networkd-link.c
@@ -2509,6 +2509,20 @@ static int link_update_lldp(Link *link) {
         return r;
 }
 
+static int link_configure_can(Link *link) {
+        int r;
+
+        if (!(link->flags & IFF_UP)) {
+                r = link_up_can(link);
+                if (r < 0) {
+                        link_enter_failed(link);
+                        return r;
+                }
+        }
+
+        return 0;
+}
+
 static int link_configure(Link *link) {
         int r;
 
@@ -2516,18 +2530,8 @@ static int link_configure(Link *link) {
         assert(link->network);
         assert(link->state == LINK_STATE_PENDING);
 
-        if (streq_ptr(link->kind, "vcan")) {
-
-                if (!(link->flags & IFF_UP)) {
-                        r = link_up_can(link);
-                        if (r < 0) {
-                                link_enter_failed(link);
-                                return r;
-                        }
-                }
-
-                return 0;
-        }
+        if (streq_ptr(link->kind, "vcan"))
+                return link_configure_can(link);
 
         /* Drop foreign config, but ignore loopback or critical devices.
          * We do not want to remove loopback address or addresses used for root NFS. */
-- 
2.17.1

